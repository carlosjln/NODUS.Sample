(function(){function n(n,t,i,r,u,f){function rt(n,t,i,r,u){var f=Math.PI/180,o=n+i*Math.cos(-r*f),s=n+i*Math.cos(-u*f),h=n+i/2*Math.cos(-(r+(u-r)/2)*f),c=t+i*Math.sin(-r*f),l=t+i*Math.sin(-u*f),a=t+i/2*Math.sin(-(r+(u-r)/2)*f),e=["M",n,t,"L",o,c,"A",i,i,0,+(Math.abs(u-r)>180),1,s,l,"z"];return e.middle={x:h,y:a},e}var e,k,ut,s,b,g,ft,et,nt,ot;f=f||{};var v=this,w=[],a=n.set(),o=n.set(),h=n.set(),l=u.length,y=0,c=0,tt=0,p=9,d=!0,st=f.donut||!1,ht=f.donutDiameter||.6666666,it=f.donutFill||"#FFFFFF";if(o.covers=a,l==1)h.push(n.circle(t,i,r).attr({fill:v.colors[0],stroke:f.stroke||"#fff","stroke-width":f.strokewidth==null?1:f.strokewidth})),a.push(n.circle(t,i,r).attr(v.shim)),c=u[0],u[0]={value:u[0],order:0,valueOf:function(){return this.value}},h[0].middle={x:t,y:i},h[0].mangle=180;else{for(e=0;e<l;e++)c+=u[e],u[e]={value:u[e],order:e,valueOf:function(){return this.value}};for(u.sort(function(n,t){return t.value-n.value}),e=0;e<l;e++)d&&u[e]*360/c<=1.5&&(p=e,d=!1),e>p&&(d=!1,u[p].value+=u[e],u[p].others=!0,tt=u[p].value);for(l=Math.min(p+1,u.length),tt&&u.splice(l)&&(u[p].others=!0),e=0;e<l;e++)k=y-360*u[e]/c/2,e||(y=90-k,k=y-360*u[e]/c/2),f.init&&(ut=rt(t,i,1,y,y-360*u[e]/c).join(",")),b=rt(t,i,r,y,y-=360*u[e]/c),u[e].value<c?(g=0,u[e].value>0&&(g=f.strokewidth==null?1:f.strokewidth),s=n.path(f.init?ut:b).attr({fill:f.colors&&f.colors[u[e].order]||v.colors[e]||"#666",stroke:f.stroke||"#fff","stroke-width":g,"stroke-linejoin":"round"}),s.value=u[e],s.middle=b.middle,s.mangle=k,w.push(s),h.push(s),f.init&&s.animate({path:b.join(",")},+f.init-1||1e3,">")):(s=n.circle(t,i,r).attr({fill:f.colors&&f.colors[u[e].order]||v.colors[0],stroke:f.stroke||"#fff","stroke-width":f.strokewidth==null?1:f.strokewidth}),ft=n.circle(t,i,r).attr(v.shim),s.customP2=ft,s.value=u[e],s.middle={x:t,y:i},s.mangle=180,w.push(s),h.push(s),f.init&&s.animate({path:b.join(",")},+f.init-1||1e3,">"));for(e=0;e<l;e++)s=w[e].customP2===undefined?n.path(w[e].attr("path")).attr(v.shim):w[e].customP2,f.href&&f.href[e]&&s.attr({href:f.href[e]}),s.attr=function(){},a.push(s),h.push(s)}return st&&(et=r*ht,nt=n.circle(t,i,et).attr({fill:it,stroke:f.stroke||it}),h.push(nt),o.donut=nt),o.hover=function(n,f){var o,e;for(f=f||function(){},o=this,e=0;e<l;e++)(function(e,s,h){var l={sector:e,cover:s,cx:t,cy:i,mx:e.middle.x,my:e.middle.y,mangle:e.mangle,r:r,value:u[h],total:c,label:o.labels&&o.labels[h]};s.mouseover(function(){n.call(l)}).mouseout(function(){f.call(l)})})(h[e],a[e],e);return this},o.each=function(n){for(var e=this,f=0;f<l;f++)(function(f,o,s){var h={sector:f,cover:o,cx:t,cy:i,x:f.middle.x,y:f.middle.y,mangle:f.mangle,r:r,value:u[s],total:c,label:e.labels&&e.labels[s]};n.call(h)})(h[f],a[f],f);return this},o.click=function(n){for(var e=this,f=0;f<l;f++)(function(f,o,s){var h={sector:f,cover:o,cx:t,cy:i,mx:f.middle.x,my:f.middle.y,mangle:f.mangle,r:r,value:u[s],total:c,label:e.labels&&e.labels[s]};o.click(function(){n.call(h)})})(h[f],a[f],f);return this},o.inject=function(n){n.insertBefore(a[0])},ot=function(e,s,y,p){var g=t+r+r/5,rt=i,d=rt+10,w,nt,k,tt,b,it;for(e=e||[],p=p&&p.toLowerCase&&p.toLowerCase()||"east",y=n[y&&y.toLowerCase()]||"circle",o.labels=n.set(),w=0;w<l;w++)nt=h[w].attr("fill"),k=u[w].order,u[w].others&&(e[k]=s||"Others"),e[k]=v.labelise(e[k],u[w],c),o.labels.push(n.set()),o.labels[w].push(n[y](g+5,d,5).attr({fill:nt,stroke:"none"})),o.labels[w].push(tt=n.text(g+20,d,e[k]||u[k]).attr(v.txtattr).attr({fill:f.legendcolor||"#000","text-anchor":"start"})),a[w].label=o.labels[w],d+=tt.getBBox().height*1.2;b=o.labels.getBBox(),it={east:[0,-b.height/2],west:[-b.width-2*r-20,-b.height/2],north:[-r-b.width/2,-r-b.height-10],south:[-r-b.width/2,r+10]}[p],o.labels.translate.apply(o.labels,it),o.push(o.labels)},f.legend&&ot(f.legend,f.legendothers,f.legendmark,f.legendpos),o.push(h,a),o.series=h,o.covers=a,o}var t=function(){};t.prototype=Raphael.g,n.prototype=new t,Raphael.fn.piechart=function(t,i,r,u,f){return new n(this,t,i,r,u,f)}})();
//@ sourceMappingURL=g.pie-fixed.min.js.map